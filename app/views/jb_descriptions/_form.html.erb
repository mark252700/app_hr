<style>
  /* Add CSS to float the button to the right */
  #addRowBtn {
    float: right;
   
  }
  #float {
    float: right;
    margin-left: 10px;
  }
</style>
<%= simple_form_for(@jb_description) do |f| %>
  <%= f.error_notification %>
  <%= f.error_notification message: f.object.errors[:base].to_sentence if f.object.errors[:base].present? %>
 <div class="row justify-content-left">
    <div class="col-sm-4">
      <div class="form-group ">
 
    <%= f.input :description, label: 'Job Description', input_html:{class: 'form-control'} %>
  </div>
  </div>
  </div>
  <br>
  <hr>
<div class="card">
  <h5 class="card-header ">Based on your job description:</h5>
  <div class="card-body">
  <div class="row justify-content-left">
    <div class="col">
      <div class="form-group ">

       <table class="table table-striped">
    <button type="button" id="addRowBtn" class="btn btn-success">+</button>
    <thead>
     
    </thead>
    <tbody id="formContainer">
      <!-- Use fields_for to handle nested attributes -->
  <%= f.fields_for :jb_performeds do |jb| %>
        <tr>
          <td>
            <div class="mb-3">
              
              <%= jb.input :job_performed, label: 'Job Performed', input_html:{class: 'form-control'} %>
            </div>
          </td>
          <td>
            <div class="mb-3">
              <label>Job Done</label>
              <%= jb.select :job_done, options_for_select(["Daily", "Monthly", "Quarterly", "Annually"], selected: "Select"), {}, class: 'form-select shorter-inputs' %>
            </div>
          </td>
          <td>
            <div class="mb-3">
              <label>Hours</label>
              <%= jb.number_field :job_hr, class: 'form-control shorter-input' %>
            </div>
          </td>
          <td>
            <div class="mb-3">
              <label>Minutes</label>
              <%= jb.number_field :job_min, class: 'form-control shorter-input' %>
            </div>
          </td>
          <td>
            <div class="mb-3">
              <label>Job Current</label>
              <div class="form-check">
                <%= jb.radio_button :job_current, 'true', class: 'form-check-input' %>
                <label class="form-check-label">Yes</label>
              </div>
              <div class="form-check">
                <%= jb.radio_button :job_current, 'false', class: 'form-check-input' %>
                <label class="form-check-label">No</label>
              </div>
            </div>
          </td>
          <td>
            <div class="mb-3">
              <label>Reason For doing this task</label>
              <%= jb.input :job_reason, label: false, input_html:{class: 'form-control long-input'} %>
            </div>
          </td>
          <td>
            <div class="mb-3">
              <br>
              <!-- Add remove button for each row -->
              <button type="button" class="btn btn-danger remove-row">Remove</button>
            </div>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>

      </div>
      </div>
      </div>
       </div>
      </div>
<br>
  <div class="form-actions">
    <%= f.button :submit, @button_label, name: 'save_button', class: action_name == 'new' ? 'btn btn-primary' : 'btn btn-success' %>
   
     <% if current_user.emp_detail.present? %>
  <%= link_to 'Previous', edit_emp_detail_path(current_user.emp_detail), class: 'btn btn-secondary', id: 'float' %>
<% end %>
  </div>
<% end %>


<script>
 document.getElementById('addRowBtn').addEventListener('click', function() {
  var tbody = document.getElementById('formContainer');
  var rowCount = tbody.getElementsByTagName('tr').length;

  var newRow = document.createElement('tr');
  newRow.innerHTML = `
    <td>
      <div class="mb-3">
        <label>Job Performed</label>
        <input type="text" name="jb_description[jb_performeds_attributes][${rowCount}][job_performed]" class="form-control">     </div>
    </td>
    <td>
      <div class="mb-3">
        <label>Job Done</label>
        <select name="jb_description[jb_performeds_attributes][${rowCount}][job_done]" class="form-select shorter-inputs">
          <option value="none" selected>Select</option>
          <option value="Daily">Daily</option>
          <option value="Monthly">Monthly</option>
          <option value="Quarterly">Quarterly</option>
          <option value="Annually">Annually</option>
        </select>
      </div>
    </td>
    <td>
      <div class="mb-3">
        <label>Hours</label>
        <input type="number" name="jb_description[jb_performeds_attributes][${rowCount}][job_hr]" class="form-control shorter-input">
      </div>
    </td>
    <td>
      <div class="mb-3">
        <label>Minutes</label>
        <input type="number" name="jb_description[jb_performeds_attributes][${rowCount}][job_min]" class="form-control shorter-input">
      </div>
    </td>
    <td>
      <div class="mb-3">
        <label>Job Current</label>
        <div class="form-check">
          <input type="radio" name="jb_description[jb_performeds_attributes][${rowCount}][job_current]" value="true" class="form-check-input">
          <label class="form-check-label">Yes</label>
        </div>
        <div class="form-check">
          <input type="radio" name="jb_description[jb_performeds_attributes][${rowCount}][job_current]" value="false" class="form-check-input">
          <label class="form-check-label">No</label>
        </div>
      </div>
    </td>
    <td>
      <div class="mb-3">
        <label>Reason For not doing this task</label>
        <input type="text" name="jb_description[jb_performeds_attributes][${rowCount}][job_reason]" class="form-control long-input">
      </div>
    </td>
    <td>
      <div class="mb-3">
        <br>
        <button type="button" class="btn btn-danger remove-row">Remove</button>
      </div>
    </td>
  `;

  tbody.appendChild(newRow);
});

// Add event listener to handle remove button clicks
document.getElementById('formContainer').addEventListener('click', function(e) {
  if (e.target && e.target.className == 'btn btn-danger remove-row') {
    var row = e.target.closest('tr');
    row.parentNode.removeChild(row);
  }
});

</script>